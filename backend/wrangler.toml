name = "heartfelt-api"
compatibility_date = "2024-01-01"
main = "src/index.js"
compatibility_flags = ["nodejs_compat"]

# Optional: KV namespace for rate limiting (recommended for production)
# [[kv_namespaces]]
# binding = "RATE_LIMIT_KV"
# id = "your_kv_namespace_id"
# preview_id = "your_preview_kv_namespace_id"
# Note: The app will use in-memory fallback if KV is not configured

[dev]
port = 8787

[[d1_databases]]
binding = "DB"
database_name = "heartfelt-db"
database_id = "b0e2b609-aa73-47af-8711-6b78fc8a5031"
preview_database_id = "b0e2b609-aa73-47af-8711-6b78fc8a5031"
migrations_dir = "./migrations"

[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "heartfelt-images"
preview_bucket_name = "heartfelt-images"

[vars]
CORS_ORIGIN = "http://localhost:5173,https://heartfelt.pages.dev,https://heartfelt-2ti.pages.dev,https://gerryrushway.github.io,https://afrodate.co.za"
SIGNUP_BONUS_TOKENS = "10"
R2_PUBLIC_BASE_URL = "https://heartfelt-images.79faac3a1f7c3b8ab3be66153def7484.r2.cloudflarestorage.com"
FRONTEND_URL = "http://localhost:5173,https://heartfelt.pages.dev,https://heartfelt-2ti.pages.dev,https://gerryrushway.github.io,https://afrodate.co.za"
PAYFAST_MERCHANT_ID = "10044315"
PAYFAST_MERCHANT_KEY = "776jae6ei74nd"
PAYFAST_PASSPHRASE = "hdgdudbhudfbjuwcb"
PAYFAST_MODE = "sandbox"
PAYFAST_SANDBOX_URL = "https://sandbox.payfast.co.za/eng/process"
PAYFAST_LIVE_URL = "https://www.payfast.co.za/eng/process"
PAYFAST_REFUND_SECRET = "CHANGE_ME"
VAPID_PUBLIC_KEY = "BP4Gu7ylk1yYktksVycMP0kbHOpRt0NgbeZpGK_ppJovxrj04pd9CoPReSi4lQj5b2YZlWwi6qSjV_bLw5YS5d0"
VAPID_SUBJECT = "mailto:support@afrodate.co.za"


[ai]
binding = "AI"

[[durable_objects.bindings]]
name = "CHAT_ROOM"
class_name = "ChatRoom"
script_name = "heartfelt-api"

[[migrations]]
tag = "v1"
new_classes = ["ChatRoom"]

[deployment]
previews_enabled = false

routes = [
  { pattern = "api.afrodate.co.za/*", zone_name = "afrodate.co.za" }
]
